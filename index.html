<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í•™ì› í­íŒŒ ì‹œë®¬ë ˆì´í„°</title>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3724d98e2b73cfb64d3d3b2df6cf02db&libraries=services&autoload=false"></script>
    
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background: #1a1a1a; color: white; text-align: center; margin: 0; }
        .header { padding: 40px; }
        .search-box { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        input { padding: 12px; width: 300px; border-radius: 5px; border: none; font-size: 16px; }
        button { padding: 12px 25px; background: #ff4757; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        
        #result-list { 
            max-width: 400px; margin: 0 auto 20px; background: #333; 
            border-radius: 8px; list-style: none; padding: 0; display: none;
            max-height: 200px; overflow-y: auto; text-align: left;
        }
        #result-list li { padding: 12px; border-bottom: 1px solid #444; cursor: pointer; }
        #result-list li:hover { background: #444; color: #ff4757; }

        #map-container { width: 90%; max-width: 800px; height: 400px; margin: 0 auto; display: none; border: 3px solid #ff4757; position: relative; }
        #map { width: 100%; height: 100%; }
        
        #destroy-panel { display: none; margin-top: 20px; }
        #boom-btn { font-size: 24px; padding: 20px 50px; border-radius: 50px; background: linear-gradient(to right, #ff4757, #ff6b81); box-shadow: 0 0 20px rgba(255, 71, 87, 0.5); }

        /* í­ë°œ ì• ë‹ˆë©”ì´ì…˜ */
        .explosion {
            position: absolute; width: 150px; height: 150px;
            background: url('https://cdn-icons-png.flaticon.com/512/426/426833.png') no-repeat center;
            background-size: contain; transform: translate(-50%, -50%) scale(0);
            pointer-events: none; z-index: 100;
        }
        @keyframes boom-ani {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); }
            100% { transform: translate(-50%, -50%) scale(2.5); opacity: 0; }
        }
        .do-boom { animation: boom-ani 0.6s ease-out forwards; }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ”¥ í•™ì› í­íŒŒ ì‹œë®¬ë ˆì´í„°</h1>
    <div class="search-box">
        <input type="text" id="keyword" placeholder="í•™ì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.">
        <button onclick="searchAcademy()">ê²€ìƒ‰</button>
    </div>
    <ul id="result-list"></ul>
</div>

<div id="map-container">
    <div id="map"></div>
    <div id="effect-layer"></div>
</div>

<div id="destroy-panel">
    <button id="boom-btn" onclick="explode()">ğŸ’¥ í­íŒŒ ğŸ’¥</button>
</div>

<script>
let map, ps, selectedPlace;

// 2. ì¹´ì¹´ì˜¤ ê°ì²´ê°€ ë¡œë“œëœ í›„ ì‹¤í–‰ë˜ë„ë¡ kakao.maps.load ì‚¬ìš©
function initMap() {
    kakao.maps.load(() => {
        const container = document.getElementById('map');
        const options = { center: new kakao.maps.LatLng(37.5668, 126.9786), level: 3 };
        map = new kakao.maps.Map(container, options);
        ps = new kakao.maps.services.Places();
        console.log("ì¹´ì¹´ì˜¤ ì§€ë„ ë¡œë“œ ì™„ë£Œ!");
    });
}

function searchAcademy() {
    const word = document.getElementById('keyword').value;
    if(!word.trim()) return alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”!");

    // ì•„ì§ psê°€ ì•ˆ ë§Œë“¤ì–´ì¡Œë‹¤ë©´ ìƒì„±
    if(!ps) { initMap(); return alert("ì§€ë„ë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ê²€ìƒ‰í•´ì£¼ì„¸ìš”."); }

    ps.keywordSearch(word, (data, status) => {
        const list = document.getElementById('result-list');
        list.innerHTML = '';
        if (status === kakao.maps.services.Status.OK) {
            list.style.display = 'block';
            data.forEach(p => {
                const li = document.createElement('li');
                li.innerHTML = `<b>${p.place_name}</b><br><small>${p.address_name}</small>`;
                li.onclick = () => selectAcademy(p);
                list.appendChild(li);
            });
        } else {
            alert("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
    });
}

function selectAcademy(place) {
    selectedPlace = place;
    document.getElementById('result-list').style.display = 'none';
    document.getElementById('map-container').style.display = 'block';
    document.getElementById('destroy-panel').style.display = 'block';

    const moveLatLon = new kakao.maps.LatLng(place.y, place.x);
    map.setCenter(moveLatLon);
    
    // ë§ˆì»¤ í‘œì‹œ
    new kakao.maps.Marker({ map: map, position: moveLatLon });
}

function explode() {
    if(!selectedPlace) return;

    const proj = map.getProjection();
    const point = proj.pointFromCoords(new kakao.maps.LatLng(selectedPlace.y, selectedPlace.x));

    const layer = document.getElementById('effect-layer');
    const boom = document.createElement('div');
    boom.className = 'explosion do-boom';
    boom.style.left = point.x + 'px';
    boom.style.top = point.y + 'px';
    layer.appendChild(boom);

    // ì§€ë„ ì§„ë™
    const container = document.getElementById('map-container');
    container.style.transition = '0.05s';
    let count = 0;
    const interval = setInterval(() => {
        container.style.transform = `translate(${Math.random()*10-5}px, ${Math.random()*10-5}px)`;
        if(count++ > 10) {
            clearInterval(interval);
            container.style.transform = 'translate(0,0)';
            alert(`${selectedPlace.place_name} í­íŒŒ ì™„ë£Œ!`);
        }
    }, 50);

    setTimeout(() => boom.remove(), 1000);
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ë°”ë¡œ ì‹¤í–‰
window.onload = initMap;
</script>

</body>
</html>