<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í•™ì› í­íŒŒ ì‹œë®¬ë ˆì´í„°</title>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3724d98e2b73cfb64d3d3b2df6cf02db&libraries=services"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; text-align: center; background: #222; color: white; margin: 0; overflow-x: hidden; }
        h1 { margin-top: 30px; color: #ff4757; text-shadow: 2px 2px 4px #000; }
        
        #search-container { padding: 30px; }
        input { padding: 12px; width: 250px; border: none; border-radius: 5px 0 0 5px; outline: none; }
        .search-btn { padding: 12px 20px; cursor: pointer; background: #ff4757; color: white; border: none; border-radius: 0 5px 5px 0; font-weight: bold; }
        
        /* ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        #result-list { 
            max-width: 500px; margin: 10px auto; background: #333; 
            border-radius: 8px; max-height: 200px; overflow-y: auto; 
            display: none; list-style: none; padding: 0; text-align: left;
        }
        #result-list li { 
            padding: 10px 15px; border-bottom: 1px solid #444; cursor: pointer; transition: 0.2s; 
        }
        #result-list li:hover { background: #444; color: #ff4757; }
        #result-list li .address { font-size: 12px; color: #aaa; display: block; }

        #map-wrapper { 
            position: relative; width: 90%; max-width: 800px; height: 450px; 
            margin: 20px auto; display: none; border: 3px solid #ff4757; border-radius: 10px; overflow: hidden;
        }
        #map { width: 100%; height: 100%; }
        
        #control-panel { display: none; padding: 20px; }
        #destroy-btn { 
            background: linear-gradient(to bottom, #ff4757, #cc0000);
            color: white; border: none; padding: 20px 50px; font-size: 24px; 
            font-weight: bold; border-radius: 50px; cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4); transition: 0.2s;
        }
        #destroy-btn:active { transform: scale(0.95); box-shadow: none; }

        /* í­íŒŒ ì• ë‹ˆë©”ì´ì…˜ */
        .explosion {
            position: absolute; width: 150px; height: 150px;
            background: url('https://cdn-icons-png.flaticon.com/512/426/426833.png') no-repeat center;
            background-size: contain; transform: translate(-50%, -50%) scale(0);
            pointer-events: none; z-index: 10;
        }
        @keyframes boom {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            30% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(2.5); opacity: 0; }
        }
        .animate-boom { animation: boom 0.6s ease-out forwards; }

        @keyframes shake {
            0% { transform: translate(2px, 2px); }
            25% { transform: translate(-2px, -2px); }
            50% { transform: translate(2px, -2px); }
            75% { transform: translate(-2px, 2px); }
            100% { transform: translate(0, 0); }
        }
    </style>
</head>
<body>

<h1>ğŸ”¥ í•™ì› í­íŒŒ ì‹œë®¬ë ˆì´í„°</h1>

<div id="search-container">
    <input type="text" id="keyword" placeholder="í•™ì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ê°•ë‚¨ ìˆ˜í•™)" onkeypress="if(event.keyCode==13) searchAcademy()">
    <button class="search-btn" onclick="searchAcademy()">ê²€ìƒ‰</button>
    <ul id="result-list"></ul>
</div>

<div id="map-wrapper">
    <div id="map"></div>
    <div id="boom-layer"></div>
</div>

<div id="control-panel">
    <button id="destroy-btn">ğŸ’¥ ì´ í•™ì› í­íŒŒí•˜ê¸° ğŸ’¥</button>
    <p id="target-name" style="margin-top: 10px; color: #ffbcbc;"></p>
</div>

<script>
let map, marker, ps;
let selectedPlace = null;

// ì§€ë„ ì´ˆê¸°í™”
function initMap() {
    const container = document.getElementById('map');
    const options = { center: new kakao.maps.LatLng(37.5668, 126.9786), level: 3 };
    map = new kakao.maps.Map(container, options);
    ps = new kakao.maps.services.Places();
}

// ê²€ìƒ‰ ì‹¤í–‰
function searchAcademy() {
    const keyword = document.getElementById('keyword').value;
    if (!keyword.trim()) return alert('í•™ì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!');

    if (!ps) initMap();

    // ì¹´ì¹´ì˜¤ ì¥ì†Œ ê²€ìƒ‰ API í˜¸ì¶œ
    ps.keywordSearch(keyword, (data, status) => {
        const listEl = document.getElementById('result-list');
        listEl.innerHTML = ''; // ì´ì „ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”

        if (status === kakao.maps.services.Status.OK) {
            listEl.style.display = 'block';
            data.forEach((place) => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${place.place_name}</strong><span class="address">${place.address_name}</span>`;
                li.onclick = () => selectAcademy(place);
                listEl.appendChild(li);
            });
        } else {
            alert('ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ê²€ìƒ‰ì–´ë¥¼ ë‹¤ë¥´ê²Œ ì…ë ¥í•´ë³´ì„¸ìš”.');
            listEl.style.display = 'none';
        }
    });
}

// ë¦¬ìŠ¤íŠ¸ì—ì„œ í•™ì› ì„ íƒ ì‹œ
function selectAcademy(place) {
    selectedPlace = place;
    document.getElementById('result-list').style.display = 'none';
    document.getElementById('map-wrapper').style.display = 'block';
    document.getElementById('control-panel').style.display = 'block';
    document.getElementById('target-name').innerText = `íƒ€ê²Ÿ ì„¤ì • ì™„ë£Œ: ${place.place_name}`;

    const moveLatLon = new kakao.maps.LatLng(place.y, place.x);
    
    if (marker) marker.setMap(null);
    marker = new kakao.maps.Marker({ position: moveLatLon });
    marker.setMap(map);
    map.setCenter(moveLatLon);
    map.setLevel(3);
}

// í­íŒŒ ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById('destroy-btn').addEventListener('click', () => {
    if (!selectedPlace) return;

    const proj = map.getProjection();
    const point = proj.pointFromCoords(new kakao.maps.LatLng(selectedPlace.y, selectedPlace.x));

    // í­íŒŒ ì´í™íŠ¸ ìƒì„±
    const boomLayer = document.getElementById('boom-layer');
    const boom = document.createElement('div');
    boom.className = 'explosion animate-boom';
    boom.style.left = point.x + 'px';
    boom.style.top = point.y + 'px';
    boomLayer.appendChild(boom);

    // ì§„ë™ íš¨ê³¼
    const mapWrapper = document.getElementById('map-wrapper');
    mapWrapper.style.animation = 'shake 0.1s infinite';

    // ê²°ê³¼ ì²˜ë¦¬
    setTimeout(() => { 
        mapWrapper.style.animation = 'none'; 
        marker.setMap(null); // ë§ˆì»¤ ì‚­ì œ
        alert(`ğŸ’¥ ${selectedPlace.place_name} ì´(ê°€) íŒŒê´´ë˜ì—ˆìŠµë‹ˆë‹¤!`);
    }, 600);

    setTimeout(() => boom.remove(), 1000);
});

// ì´ˆê¸° ì§€ë„ ê°ì²´ ìƒì„±ì„ ìœ„í•´ í˜¸ì¶œ
window.onload = initMap;
</script>

</body>
</html>